// example from: Disintegration and Bayesian Inversion, Both Abstractly and Concretely by K Cho and B Jacobs

def hoursPrior(μ,ν){
	return sample(infer((){
		r := gauss(μ,ν);
		observe(0<=r && r<=8);
		return r;
	}));
}

def main(){
	isWeekend := flip(2/7);
	hour := if isWeekend { hoursPrior(5,4^2) } else { hoursPrior(2,4^2) };
	cobserve(hour,6);
	return isWeekend; // expected: (2/7·[(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)≠0]·[5·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))=0]+5·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))≠0]·⅟((d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))·4)·⅟√̅2·⅟√̅e+⅟((d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)·4)·⅟e^(1/32)·√̅2≠0]·δ(1)[isWeekend]·⅟((d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)·4)·⅟e^(1/32)·⅟√̅2+5/7·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))≠0]·[2·[(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)=0]+5·⅟((d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))·4)·⅟√̅2·⅟√̅e+[(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)≠0]·⅟((d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)·4)·⅟e^(1/32)·√̅2≠0]·δ(0)[isWeekend]·⅟((d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))·4)·⅟√̅2·⅟√̅e)·([(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)=0]·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))=0]+[(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)=0]·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))≠0]·⅟(2/7+5/7·⅟((d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))·4)·⅟√̅2·⅟√̅e)+[(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)≠0]·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))=0]·⅟(2/7·⅟((d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)·4)·⅟e^(1/32)·⅟√̅2+5/7)+[(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)≠0]·[(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))≠0]·⅟(2/7·⅟((d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-5/4·⅟√̅2)·4)·⅟e^(1/32)·⅟√̅2+5/7·⅟((d/dx)⁻¹[e^(-x²)](-⅟2^(3/2)+√̅2)·4+-(d/dx)⁻¹[e^(-x²)](-⅟2^(3/2))·4)·⅟√̅2·⅟√̅e))
	// Pr[isWeekend] ≈ 0.37421
	// TODO: simplify better, e.g. remove Iverson brackets
}

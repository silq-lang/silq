def QFT[n:!](: int[n])mfree: int[n]{
	for k in [0..n div 2){
		([k],[n-k-1]) := ([n-k-1],[k]);
	}
	for k in [0..n){
		[k] := H([k]);
		for l in [k+1..n){
			if [k] && [l]{
				phase(2路路2^(k-l-1));
			}
		}
	}
	return ;
}

def scQFT[n:!](: int[n]): !int[n]{
	:= as ^n;
	r:=0:!int[n];
	for k in [0..n div 2){
		([k],[n-k-1]) := ([n-k-1],[k]);
	}
	for k in [0..n){
		[H(x)]~ := ;
		r[k] = measure(x);
		if r[k]{
			for l in [0..n-k-1){
				if [l] {
					phase(2路路2^(-l-2));
				}
			}
		}
	}
	():=;
	return r;
}

n:=5;
def main(){
	x:=0:int[n];
	for i in 0..n{ x[i]:=H(x[i]); }
	x:=measure(x);
	assert(scQFT(reverse(QFT)(x))==x);
	return x;
}

// args: --tape
import qft,groverDiffusion;

def groverMfree[n:!â„•](f: const uint[n] !â†’ lifted ğ”¹)mfree: uint[n]{
	nIterations:=floor(Ï€/(4Â·asin(2^(-n/2))));
	cand:=0:uint[n];
    for k in [0..n){ cand[k]:=H(cand[k]); }
	for k in [0..nIterations){
		if f(cand){ phase(Ï€); }
		cand:=groverDiffusion(cand);
	}
	return cand;
}

def deutschJozsaMfree[n:!â„•](f: ğ”¹^n !â†’lifted ğ”¹)mfree: ğ”¹^n{
	x:=0:int[n];
	for i in [0..n){ x[i] := H(x[i]); }
	if f(x as ğ”¹^n){ phase(Ï€); }
	for i in [0..n){ x[i] := H(x[i]); }
	return x as ğ”¹^n;
}


def bernsteinVaziraniMfree()mfree:ğ”¹^5{
	b:=(0,1,0,1,1):!ğ”¹^5;
	f:=(x:ğ”¹^5)lifted{
		r:=0:ğ”¹;
		for k in [0..5){
			râŠ•=b[k]&x[k];
		}
		return r;
	};
	return deutschJozsaMfree(f);
}

def main(){
	n:=3;
	r:=reverse(QFT[3])(QFT(0:int[3]));
	r:=reverse(QFT)(QFT(r));
	s:=groverMfree((x:uint[6])liftedâ‡’x==42);
	t:=bernsteinVaziraniMfree();
	return (r,s,t);
}

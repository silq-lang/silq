// args: --run

def toW[n:!]lifted:^n mfree ^nlambda(qs:^n)mfree:^n{
	if n==1{ qs[0]:=X(qs[0]); }
	else if n>1{
		(([head] coerce ^1):[])~((tail coerce ^(n sub 1)):[]):=(qs:[]);
		胃:=asin(1/sqrt(n));
		head:=rotY(胃,head);
		if !head { tail := toW(tail); }
		qs:=[head]~(tail:[]) coerce B^n;
	}
	return qs;
};
def solve(qs:^3):!{
	if qs[1]{ phase(-2路/3); }
	if qs[2]{ phase(-4路/3); }
	qs:=reverse(toW[3])(qs);
	return measure(qs as int[3])!=0;
}
def main(){
	qs:=toW(vector(3,0:));
	if qs[1]{ phase(2路/3); }
	if qs[2]{ phase(4路/3); }
	assert(!solve(qs));
}

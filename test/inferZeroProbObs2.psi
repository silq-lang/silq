
def main(){
	x := flip(1/2);
	d := Dirac[ğŸ™](); // TODO: fix type inference
	y := d.then((){ observe(x == flip(1/2)+1); return x; });
	return y.sample(); // expected: (2Â·[-râ‚+1=0]+2Â·[-râ‚+2=0])Â·([-râ‚+1=0]+[-râ‚+2=0])Â·([-râ‚+1=0]Â·â…Ÿ2+[-râ‚+2=0]Â·â…Ÿ2)Â·(Î´[-râ‚+1]Â·â…Ÿ2+Î´[râ‚]Â·â…Ÿ2)
	// TODO: simplify better
}

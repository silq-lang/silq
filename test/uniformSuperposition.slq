// according to: https://quantumcomputing.stackexchange.com/a/11740

def H_n[n:!‚Ñï](xs:ùîπ^n){
	for i in 0..n{ xs[i]:=H(xs[i]); }
	return xs;
}

def uniformSuperposition(N:!‚Ñï)mfree{
	(k,L):=(0,N);
	while (L&1)=0 { L div=2; k+=1; }
	(t,logL):=(1,0);
	while t<L { t¬∑=2; logL+=1; }
	a:=H_n(vector(logL,0));
	œÜ:=acos(1-2^(logL-1)/L);
	if (a as uint[logL])<L { phase(œÜ); }
	with a:=H_n(a) do if (a as uint[logL])=0{ phase(œÜ); }
	return H_n(vector(k,0))~a coerce ùîπ^(ceil(log(N)/log(2)) coerce !‚Ñï) as uint[ceil(log(N)/log(2)) coerce !‚Ñï];
}

def main()‚áíuniformSuperposition(3);

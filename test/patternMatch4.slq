// args: --run

def task[state](
	numbers: !â„[],
	prepareState: !(Î (n:!â„•). state^n),
){
	n:=numbers.length;
	Ï†:=prepareState(n):state[];
	[head]~Ï†:=Ï†;
	measure(head,Ï†);
}
def prepareState(n:!â„•){
	Ï†:=[]:(ğ”¹^2)[];
	last:=0:ğ”¹;
	for i in [0..n){
		bit:=H(0:ğ”¹);
		next:=dup(bit);
		Ï†~=[(last,bit)];
		last:=next;
	}
	measure(last);
	return Ï† coerce (ğ”¹^2)^n;
}
def main(){
	numbers:=[1/2,1/2];
	return task[ğ”¹^2](numbers,prepareState);
}

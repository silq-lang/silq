// explicit requests from participants:
import int_fixed_point_util;
def mainâ‚€()â‡’toRange[-1.0,1.0](sinQ[1000,1000](fromAngle[1000](Ï€/4)));

// ---
	
// import int_fixed_point_util;
def mainâ‚()â‡’toRange[0.0,1](invQ[10,10,0.1](fromRange[0,1][10](0.2)));

// ---

// import int_fixed_point_util;

def mainâ‚‚(){
	x:=H(0:ğ”¹);
	if x{ phaseQ(fromAngle[20](Ï€/3)); }
	if x{ phaseQ(fromAngle[20](-Ï€/3)); }
	return H(x);
}

// ---

// import int_fixed_point_util;
def mainâ‚ƒ()â‡’toAngle(asinQ[50,100](fromRange[-1,1][50](-0.3)));

// ---

// import int_fixed_point_util;
def mainâ‚„(){
	x:=0:uint[5];
	for i in [0..5){
		x[i]:=H(x[i]);
	}
	r:=asinQ[5,10](x);
	(x,r):=measure(x,r);
	return (toRange[-1.0,1.0](x),toAngle(r),x,r);
}


// ---

def mainâ‚…(){
	x:=H(0:ğ”¹);
	if measure(H(0:ğ”¹)){
		x:=measure(x);
	}
	return x; // new: works, combines types !ğ”¹ and ğ”¹ of x to ğ”¹
}

def mainâ‚†(){
	x:=H(0:ğ”¹);
	y:=0:ğ”¹;
	x:=X(x);
	if x{
		y:=X(y);
	}
	forget(y); // new: works
	return x;
}


// --------------



// other improvements:

def mainâ‚‡(){
	x:=H(0:ğ”¹);
	def foo(){
		// x:=x; // no longer needed
		y:=H(0:ğ”¹);
		if y { x:=H(x); }
		return (x,y);
	}
	return foo();
}

// ---

def foo[a](x:!a^2){}
def bar[a](x:!a[]){}
def mainâ‚ˆ(){
	x:=(1,-1);
	foo(x); // new: works
	y:=vector(2,1);
	bar(x); // new: works
	bar(y); // new: works
}

// ---

def test[Ï„](x:Ï„[]){
	[a]~b:=x; // pattern matching against array concatenation
	return (a,b);
}

// ---

def mainâ‚‰(){
	a:=[1,2,3];
	[x,y,z]:=a; // pattern matching against array literals
	return (x,y);
}

// ---

def mainâ‚â‚€(){
	x:=H(0:ğ”¹);
	xâ‚€:=if x then (1:!ğ”¹,0:ğ”¹) else vector(2,0:ğ”¹); // new: works
	xâ‚:=if x then vector(2,0:ğ”¹) else (1:!ğ”¹,0:ğ”¹); // new: works
	return (x,xâ‚€,xâ‚);
}

// ---

def mainâ‚â‚(){
	def r()â‡’measure(H(0:ğ”¹));
	xâ‚€:=if r() then (0:!ğ”¹,0:ğ”¹) else vector(2,0:ğ”¹); // new: works
	xâ‚:=if r() then vector(2,0:ğ”¹) else (0:!ğ”¹,0:ğ”¹); // new: works
	yâ‚€:=if r() then array(2,0:ğ”¹) else (0:!ğ”¹,0:ğ”¹); // new: works
	yâ‚:=if r() then (0:!ğ”¹,0:ğ”¹) else array(2,0:ğ”¹); // new: works
	zâ‚€:=if r() then vector(2,0:ğ”¹) else array(2,0:ğ”¹); // new: works
	zâ‚:=if r() then array(2,0:ğ”¹) else vector(2,0:ğ”¹); // new: works
	return (xâ‚€,xâ‚,yâ‚€,yâ‚,zâ‚€,zâ‚);
}

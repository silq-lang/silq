// args: --run

def makeUniform(k:!â„•):uint[logâ‚‚(k)]{
	while true{
		x:=0:uint[logâ‚‚(k)];
		for i in 0..logâ‚‚(k){ x[i]:=H(x[i]); }
		if measure(x<k){ return x; }
		measure(x);
	}
}

def logâ‚‚(k:!â„•)qfree:!â„• â‡’ if k=1 then 0 else 1+logâ‚‚((k+1) div 2);

def uniformToW[k:!â„•](x:uint[logâ‚‚(k)])qfree:ð”¹^k{
	y:=vector(k,0:ð”¹);
	for i in 0..k{ y[i]=x=i; }
	def getx(const y:ð”¹^k,const i:!â„•)qfree:uint[logâ‚‚(k)]{ /// TODO
		if i==0{ return 0 as uint[logâ‚‚(k)]; }
		else if y[i]{ return i as uint[logâ‚‚(k)]; }
		else { return getx(y,i sub 1); }
	}
	getx(y,k sub 1):=x; /// TODO
	return y;
}

def main(){
	return uniformToW(makeUniform(3));
}
